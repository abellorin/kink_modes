#include <iostream>
#include <iomanip>
#include <fstream>
#include <cmath>
#include <Graph/Graph.h>

using namespace std;

void   tridag(double *ta, double *tb, double *tc, double *td, double *tu, int n);
double Force(double u);
double F1(double x, double B); 
double Cond_I_0(double x, double B, double C1, double C2, double C3, double Ck);
double Cond_I_1(double x);
void makeAgr(char *Agr, int L);

int main(int argc, char **argv)
{
	double B, C1, C2, C3, Ck, gamma;
	double **u, *u_x, *u_t, *f, *f1, *x, t, c[11];
	double *ta, *tb, *tc, *td, *tu;
	double IS, PS, h, k, x_cm, v_cm, x_cma, tmp1, tmp2;
	int File_Flag, M, N, L, i, j, P, Grafica;
	int XMax, YMax, *X, *U, *F, X_Zero, Y_Zero;
	char Ser[32], Poi[32], Per[32], Agr[32];
	ofstream fSer, fPoi, fPer, fAgr;
	
	if(argc != 2) {
		cerr << "\nMissing parameter file";
		cerr << "\nUsage: " << argv[0] << " <parameter file>" << endl;
		exit(-1);
	}
	// Read initial parameter from input file argv[1]
	ifstream fIn (argv[1]);
	if(!fIn) {
		cerr << "\nCould not open " << argv[1] << endl;
		exit(-1);
	}
	(fIn.ignore (10)) >> File_Flag;
	(fIn.ignore (10)) >> M;
	(fIn.ignore (10)) >> N;
	(fIn.ignore (10)) >> L;
	(fIn.ignore (10)) >> Grafica;
	(fIn.ignore (10)) >> gamma;
	(fIn.ignore (10)) >> B;
	(fIn.ignore (10)) >> C1;
	(fIn.ignore (10)) >> C2;
	(fIn.ignore (10)) >> C3;
	(fIn.ignore (10)) >> Ck;
	(fIn.ignore (10)) >> IS;
	(fIn.ignore (10)) >> PS;
	fIn.close();
	
	// Initialize auxiliary parameter
	P = (int)(M/2.0 +0.5);
	
	// Initialize Graph
	XMax = 640;
	YMax = 480;
	X_Zero = ((float)XMax/2.0 +0.5);
	Y_Zero = ((float)YMax/2.0 +0.5);
	Graph g1(XMax, YMax);
	
	// Setup output files names
	sprintf(Ser, "%s_serie.dat", argv[1]);
	sprintf(Poi, "%s_poincare.dat", argv[1]);
	sprintf(Per, "%s_perfil.dat", argv[1]);
	sprintf(Agr, "%s_grace.agr", argv[1]);
	
	// Open output files as needed
	if(File_Flag >= 1) {
		fPoi.open(Poi);
		fPoi.width(12);
		fPoi.precision(8);
	}
	if(File_Flag >= 2) {
		fSer.open(Ser);
		fSer.width(12);
		fSer.precision(8);
	}
	if(File_Flag == 4) {
		fPer.open(Per);
		fPer.width(12);
		fPer.precision(8);
	}
	if(File_Flag == 8) {
		makeAgr(Agr, L);
		fAgr.open(Agr,ios::app);
		fAgr.width(12);
		fAgr.precision(8);
	}
	
	// Create variables
	u = new double *[2];
	u[0] = new double[M+1];
	u[1] = new double[M+1];
	u_t = new double[M+1];
	u_x = new double[M+1];
	f = new double[M+1];
	x = new double[M+1];
	X = new int[M+1];
	U = new int[M+1];
	F = new int[M+1];
	ta = new double[M+1];
	tb = new double[M+1];
	tc = new double[M+1];
	td = new double[M+1];
	tu = new double[M+1];
	h = (double)L/(double)M;
	k = h/10.00;
	c[0] = 1.0/(h*h);
	c[1] = 2.0*c[0];
	c[2] = 0.00;
	c[3] = 1.0/(k*k);
	c[4] = 2.0*c[3];
	c[5] = 2.0/k;
	c[6] = gamma/(2.0*k);
	c[7] = c[1] + c[4];
	c[8] = -gamma + c[5];
	c[9] = c[1] + c[3] + c[6];
	c[10] = -c[3] + c[6];
  	j = 0;
	t = 0.00;
	
	for(i=0;i<=M;i++) {
		x[i] = (double)i*h - 0.50*(double)L;
		X[i] = int((float)i/(float)M*(float)XMax);
		u[1][i] = Cond_I_0(x[i], B, C1, C2, C3, Ck);
		u[0][i] = Cond_I_1(x[i]);
		u_t[i] = u[0][i];
		U[i] = Y_Zero - u[1][i]*(float)YMax/PS;
		f[i] = F1(x[i], B);
		F[i] = Y_Zero - f[i]*(float)YMax/IS;
		ta[i] = -c[0];
		tb[i] = c[7];
		tc[i] = -c[0];
		td[i] = c[4]*u[1][i] + c[8]*u[0][i] + Force(u[1][i]) + f[i];
		
	}
	ta[0] = 0.0;
	tc[0] = -c[1];
	td[0] = td[0] - c[2];
	ta[M] = -c[1];
	tc[M] = 0.0;
	td[M] = td[M] + c[2];
	u_x[0] = 0.00;
	u_x[M] = 0.00;
	tmp1 = 0.00;
	tmp2 = 0.00;
	for(i=1;i<M;i++) {
		u_x[i] = (u[1][i+1]-u[1][i-1])/(2.00*h);
		tmp1 += x[i]*u_x[i]*u_x[i];
		tmp2 += u_x[i]*u_x[i];
	}
	x_cm = tmp1/tmp2;
	x_cma = x_cm;
	v_cm = 0.00;
	
	if(Grafica == 1) {
		g1.show();
		g1.setbkcolor(BLACK);
		g1.setcolor(CYAN);
		g1.settitle("What you see is what you get");
		g1.line(0, g1.height()/2, g1.width(), g1.height()/2);
		g1.line(g1.width()/2, 0, g1.width()/2, g1.height());
		g1.setcolor(GREEN);
		g1.points(X,U,M);
		g1.setcolor(RED);
		g1.points(X,F,M);
	}
	
	if(File_Flag >= 1) 
		fPoi << x_cm << "\t"
		     << v_cm << "\t"
		     << u[1][P] << "\t"
		     << u_t[P] 
		<< endl;
	if(File_Flag >= 2)
		fSer << t << "\t"
		     << x_cm << "\t"
		     << v_cm << "\t"
		     << u[1][P] << "\t"
		     << u_x[P] 
		<< endl;
	if((File_Flag == 4) && (j%4 == 0)) {
		for(i=0;i<M;i+=4)
			fPer << u[1][i] << " ";
		fPer << u[1][M] << endl;
	}
	if((File_Flag == 8) && (j%(N/8) == 0)) {
		fAgr << "@target G" << (j/(N/8)) << ".S0" << endl;
		fAgr << "@type xy" << endl;
		for(i=0;i<=M;i+=2)
			fAgr << x[i] << " " << u[1][i] << endl;
		fAgr << endl;
	}
	
	for(j=1;j<=N;j++) {
		tridag(ta,tb,tc,td,tu,M);
		t = (double)j*k;
		for(i=0;i<=M;i++) {
			u[0][i] = u[1][i];
			u[1][i] = tu[i];
			u_t[i] = (u[1][i] - u[0][i])/k;
			U[i] = Y_Zero - u[1][i]*(float)YMax/PS;
			tb[i] = c[9];
			td[i] = c[4]*u[1][i] + c[10]*u[0][i] + Force(u[1][i]) + f[i];
		}
		td[0] = td[0] - c[2];
		td[M] = td[M] + c[2];
		
		if(Grafica == 1) {
			g1.clear();
			g1.setcolor(CYAN);
			g1.line(0, g1.height()/2, g1.width(), g1.height()/2);
			g1.line(g1.width()/2, 0, g1.width()/2, g1.height());
			g1.setcolor(GREEN);
			g1.points(X,U,M);
			g1.setcolor(RED);
			g1.points(X,F,M);
		}
		
		tmp1 = 0.00;
		tmp2 = 0.00;
		for(i=1;i<M;i++) {
			u_x[i] = (u[1][i+1] - u[1][i-1])/(2.00*h);
			tmp1 += x[i]*u_x[i]*u_x[i];
			tmp2 += u_x[i]*u_x[i];
		}
		x_cm = tmp1/tmp2;
		v_cm = (x_cm - x_cma)/k;
		x_cma = x_cm;
		if(File_Flag >= 1) 
			fPoi << x_cm << "\t"
			     << v_cm << "\t"
			     << u[1][P] << "\t"
			     << u_t[P] 
			<< endl;
		if(File_Flag >= 2)
			fSer << t << "\t"
			     << x_cm << "\t"
			     << v_cm << "\t"
			     << u[1][P] << "\t"
			     << u_x[P] 
			<< endl;
		if((File_Flag == 4) && (j%4 == 0)) {
			for(i=0;i<M;i+=4)
				fPer << u[1][i] << " ";
			fPer << u[1][M] << endl;
		}
		if((File_Flag == 8) && (j%(N/8) == 0)) {
			fAgr << "@target G" << (j/(N/8)) << ".S0" << endl;
			fAgr << "@type xy" << endl;
			for(i=0;i<=M;i+=2)
				fAgr << x[i] << " " << u[1][i] << endl;
			fAgr << endl;
		}
	}
	if(File_Flag >= 1)
		fPoi.close();
	if(File_Flag >= 2)
		fSer.close();
	if(File_Flag == 4)
		fPer.close();
	if(File_Flag == 8)
		fAgr.close();

	return(0);
}

void tridag(double *ta, double *tb, double *tc, double *td, double *tu, int M)
{
	int     j;
	double  bet, *r;
	
	r = new double[M+1];
	bet = tb[0];
	if(bet == 0.0) {
		fprintf(stderr,"Error 1000 in trigad\n");
		exit(-2);
	}
	tu[0] = td[0]/bet;
	for(j=1;j<=M;j++) {
		r[j] = tc[j-1]/bet;
		bet = tb[j] - ta[j]*r[j];
		if(bet == 0.0) {
			fprintf(stderr,"Error 2000 in trigad\n");
			exit(-2);
		}
		tu[j] = (td[j] - ta[j]*tu[j-1])/bet;
	}
	for(j=(M-1);j>=0;j--)
		tu[j] -= r[j+1]*tu[j+1];
	delete[]r;
}

double Force(double y)
{
	double s;
	s = -sin(y);
	return(s);
}

double F1(double x, double B)
{
	double r, t0, t1, t2, t3;
	t0 = B*x;
	t1 = pow(t0,2.00);
	t2 = (2.00*B*B-1.00)*x-t1*x;
	t3 = 1+t1;
	r = 2.00*B*t2/pow(t3,2.00);
	return(r);
}

double Cond_I_0(double x, double B, double C1, double C2, double C3, double Ck)
{
	double  r, t0, t1, t2, t3, t4 ,t5 ,t6, f1, f2, f3, fk;
	t0 = B*x;
	t1 = cosh(t0);
	t2 = sinh(t0);
	t3 = sin(t0);
	t4 = cos(t0);
	t5 = pow(t1,2.00);
	t6 = pow(t1,4.00);
	f1 = t2/t6;
	f2 = (1.00/t6) - (6.00/7.00)/t5;
	f3 = f1 - (4.00/7.00)*t2/t5;
	fk = 3.00*t3*t2*t2/t5 - 6.00*t4*t2/t1 - 5.00*t3;
	r = 2.00*atan(t0) + M_PI + C1*f1 + C2*f2 + C3*f3 + Ck*fk;
    return(r);
}

double Cond_I_1(double x)
{
	double  r;
	r = 0.00;
	return(r);
}

void makeAgr(char *Agr, int L)
{
	int i;
	ofstream fAgr;
	fAgr.open(Agr);
	fAgr << "# Grace project file" << endl;
	fAgr << "#" << endl;
	fAgr << "@version 50122" << endl;
	fAgr << "@page size 792, 612" << endl;
	fAgr << "@page scroll 5%" << endl;
	fAgr << "@page inout 5%" << endl;
	fAgr << "@link page off" << endl;
	fAgr << "@map font 8 to \"Courier\", \"Courier\"" << endl;
	fAgr << "@map font 10 to \"Courier-Bold\", \"Courier-Bold\"" << endl;
	fAgr << "@map font 11 to \"Courier-BoldOblique\", \"Courier-BoldOblique\"" << endl;
	fAgr << "@map font 9 to \"Courier-Oblique\", \"Courier-Oblique\"" << endl;
	fAgr << "@map font 4 to \"Helvetica\", \"Helvetica\"" << endl;
	fAgr << "@map font 6 to \"Helvetica-Bold\", \"Helvetica-Bold\"" << endl;
	fAgr << "@map font 7 to \"Helvetica-BoldOblique\", \"Helvetica-BoldOblique\"" << endl;
	fAgr << "@map font 15 to \"Helvetica-Narrow\", \"Helvetica-Narrow\"" << endl;
	fAgr << "@map font 16 to \"Helvetica-Narrow-Bold\", \"Helvetica-Narrow-Bold\"" << endl;
	fAgr << "@map font 17 to \"Helvetica-Narrow-BoldOblique\", \"Helvetica-Narrow-BoldOblique\"" << endl;
	fAgr << "@map font 18 to \"Helvetica-Narrow-Oblique\", \"Helvetica-Narrow-Oblique\"" << endl;
	fAgr << "@map font 5 to \"Helvetica-Oblique\", \"Helvetica-Oblique\"" << endl;
	fAgr << "@map font 20 to \"NewCenturySchlbk-Bold\", \"NewCenturySchlbk-Bold\"" << endl;
	fAgr << "@map font 21 to \"NewCenturySchlbk-BoldItalic\", \"NewCenturySchlbk-BoldItalic\"" << endl;
	fAgr << "@map font 22 to \"NewCenturySchlbk-Italic\", \"NewCenturySchlbk-Italic\"" << endl;
	fAgr << "@map font 23 to \"NewCenturySchlbk-Roman\", \"NewCenturySchlbk-Roman\"" << endl;
	fAgr << "@map font 24 to \"Palatino-Bold\", \"Palatino-Bold\"" << endl;
	fAgr << "@map font 25 to \"Palatino-BoldItalic\", \"Palatino-BoldItalic\"" << endl;
	fAgr << "@map font 26 to \"Palatino-Italic\", \"Palatino-Italic\"" << endl;
	fAgr << "@map font 27 to \"Palatino-Roman\", \"Palatino-Roman\"" << endl;
	fAgr << "@map font 12 to \"Symbol\", \"Symbol\"" << endl;
	fAgr << "@map font 2 to \"Times-Bold\", \"Times-Bold\"" << endl;
	fAgr << "@map font 3 to \"Times-BoldItalic\", \"Times-BoldItalic\"" << endl;
	fAgr << "@map font 1 to \"Times-Italic\", \"Times-Italic\"" << endl;
	fAgr << "@map font 0 to \"Times-Roman\", \"Times-Roman\"" << endl;
	fAgr << "@map font 33 to \"ZapfChancery-MediumItalic\", \"ZapfChancery-MediumItalic\"" << endl;
	fAgr << "@map font 13 to \"ZapfDingbats\", \"ZapfDingbats\"" << endl;
	fAgr << "@map font 35 to \"LMRoman10-Bold\", \"LMRoman10-Bold\"" << endl;
	fAgr << "@map font 36 to \"LMRoman10-BoldItalic\", \"LMRoman10-BoldItalic\"" << endl;
	fAgr << "@map font 37 to \"LMRoman10-BoldOblique\", \"LMRoman10-BoldOblique\"" << endl;
	fAgr << "@map font 38 to \"LMRoman10-CapsOblique\", \"LMRoman10-CapsOblique\"" << endl;
	fAgr << "@map font 39 to \"LMRoman10-CapsRegular\", \"LMRoman10-CapsRegular\"" << endl;
	fAgr << "@map font 40 to \"LMRoman10-Demi\", \"LMRoman10-Demi\"" << endl;
	fAgr << "@map font 41 to \"LMRoman10-DemiOblique\", \"LMRoman10-DemiOblique\"" << endl;
	fAgr << "@map font 42 to \"LMRoman10-Dunhill\", \"LMRoman10-Dunhill\"" << endl;
	fAgr << "@map font 43 to \"LMRoman10-DunhillOblique\", \"LMRoman10-DunhillOblique\"" << endl;
	fAgr << "@map font 44 to \"LMRoman10-Italic\", \"LMRoman10-Italic\"" << endl;
	fAgr << "@map font 45 to \"LMRoman10-Oblique\", \"LMRoman10-Oblique\"" << endl;
	fAgr << "@map font 46 to \"LMRoman10-Regular\", \"LMRoman10-Regular\"" << endl;
	fAgr << "@map font 47 to \"LMRoman10-Unslanted\", \"LMRoman10-Unslanted\"" << endl;
	fAgr << "@map font 48 to \"LMSans10-Bold\", \"LMSans10-Bold\"" << endl;
	fAgr << "@map font 49 to \"LMSans10-BoldOblique\", \"LMSans10-BoldOblique\"" << endl;
	fAgr << "@map font 50 to \"LMSans10-DemiCondensed\", \"LMSans10-DemiCondensed\"" << endl;
	fAgr << "@map font 51 to \"LMSans10-DemiCondensedOblique\", \"LMSans10-DemiCondensedOblique\"" << endl;
	fAgr << "@map font 52 to \"LMSans10-Oblique\", \"LMSans10-Oblique\"" << endl;
	fAgr << "@map font 53 to \"LMSans10-Regular\", \"LMSans10-Regular\"" << endl;
	fAgr << "@map font 54 to \"LMSansQuotation8-Bold\", \"LMSansQuotation8-Bold\"" << endl;
	fAgr << "@map font 55 to \"LMSansQuotation8-BoldOblique\", \"LMSansQuotation8-BoldOblique\"" << endl;
	fAgr << "@map font 56 to \"LMSansQuotation8-Oblique\", \"LMSansQuotation8-Oblique\"" << endl;
	fAgr << "@map font 57 to \"LMSansQuotation8-Regular\", \"LMSansQuotation8-Regular\"" << endl;
	fAgr << "@map font 58 to \"LMTypewriter10-CapsOblique\", \"LMTypewriter10-CapsOblique\"" << endl;
	fAgr << "@map font 59 to \"LMTypewriter10-CapsRegular\", \"LMTypewriter10-CapsRegular\"" << endl;
	fAgr << "@map font 60 to \"LMTypewriter10-Dark\", \"LMTypewriter10-Dark\"" << endl;
	fAgr << "@map font 61 to \"LMTypewriter10-DarkOblique\", \"LMTypewriter10-DarkOblique\"" << endl;
	fAgr << "@map font 62 to \"LMTypewriter10-Italic\", \"LMTypewriter10-Italic\"" << endl;
	fAgr << "@map font 63 to \"LMTypewriter10-Light\", \"LMTypewriter10-Light\"" << endl;
	fAgr << "@map font 64 to \"LMTypewriter10-LightCondensed\", \"LMTypewriter10-LightCondensed\"" << endl;
	fAgr << "@map font 65 to \"LMTypewriter10-LightCondensedOblique\", \"LMTypewriter10-LightCondensedOblique\"" << endl;
	fAgr << "@map font 66 to \"LMTypewriter10-LightOblique\", \"LMTypewriter10-LightOblique\"" << endl;
	fAgr << "@map font 67 to \"LMTypewriter10-Oblique\", \"LMTypewriter10-Oblique\"" << endl;
	fAgr << "@map font 68 to \"LMTypewriter10-Regular\", \"LMTypewriter10-Regular\"" << endl;
	fAgr << "@map font 69 to \"LMTypewriterVarWd10-Dark\", \"LMTypewriterVarWd10-Dark\"" << endl;
	fAgr << "@map font 70 to \"LMTypewriterVarWd10-DarkOblique\", \"LMTypewriterVarWd10-DarkOblique\"" << endl;
	fAgr << "@map font 71 to \"LMTypewriterVarWd10-Light\", \"LMTypewriterVarWd10-Light\"" << endl;
	fAgr << "@map font 72 to \"LMTypewriterVarWd10-LightOblique\", \"LMTypewriterVarWd10-LightOblique\"" << endl;
	fAgr << "@map font 73 to \"LMTypewriterVarWd10-Oblique\", \"LMTypewriterVarWd10-Oblique\"" << endl;
	fAgr << "@map font 74 to \"LMTypewriterVarWd10-Regular\", \"LMTypewriterVarWd10-Regular\"" << endl;
	fAgr << "@map color 0 to (255, 255, 255), \"white\"" << endl;
	fAgr << "@map color 1 to (0, 0, 0), \"black\"" << endl;
	fAgr << "@map color 2 to (255, 0, 0), \"red\"" << endl;
	fAgr << "@map color 3 to (0, 255, 0), \"green\"" << endl;
	fAgr << "@map color 4 to (0, 0, 255), \"blue\"" << endl;
	fAgr << "@map color 5 to (255, 255, 0), \"yellow\"" << endl;
	fAgr << "@map color 6 to (188, 143, 143), \"brown\"" << endl;
	fAgr << "@map color 7 to (220, 220, 220), \"grey\"" << endl;
	fAgr << "@map color 8 to (148, 0, 211), \"violet\"" << endl;
	fAgr << "@map color 9 to (0, 255, 255), \"cyan\"" << endl;
	fAgr << "@map color 10 to (255, 0, 255), \"magenta\"" << endl;
	fAgr << "@map color 11 to (255, 165, 0), \"orange\"" << endl;
	fAgr << "@map color 12 to (114, 33, 188), \"indigo\"" << endl;
	fAgr << "@map color 13 to (103, 7, 72), \"maroon\"" << endl;
	fAgr << "@map color 14 to (64, 224, 208), \"turquoise\"" << endl;
	fAgr << "@map color 15 to (0, 139, 0), \"green4\"" << endl;
	fAgr << "@reference date 0" << endl;
	fAgr << "@date wrap off" << endl;
	fAgr << "@date wrap year 1950" << endl;
	fAgr << "@default linewidth 1.0" << endl;
	fAgr << "@default linestyle 1" << endl;
	fAgr << "@default color 1" << endl;
	fAgr << "@default pattern 1" << endl;
	fAgr << "@default font 0" << endl;
	fAgr << "@default char size 1.000000" << endl;
	fAgr << "@default symbol size 1.000000" << endl;
	fAgr << "@default sformat \"%.8g\"" << endl;
	fAgr << "@background color 0" << endl;
	fAgr << "@page background fill on" << endl;
	fAgr << "@timestamp off" << endl;
	fAgr << "@timestamp 0.03, 0.03" << endl;
	fAgr << "@timestamp color 1" << endl;
	fAgr << "@timestamp rot 0" << endl;
	fAgr << "@timestamp font 0" << endl;
	fAgr << "@timestamp char size 1.000000" << endl;
	fAgr << "@timestamp def \"Thu Apr  9 15:31:07 2009\"" << endl;
	fAgr << "@r0 off" << endl;
	fAgr << "@link r0 to g0" << endl;
	fAgr << "@r0 type above" << endl;
	fAgr << "@r0 linestyle 1" << endl;
	fAgr << "@r0 linewidth 1.0" << endl;
	fAgr << "@r0 color 1" << endl;
	fAgr << "@r0 line 0, 0, 0, 0" << endl;
	fAgr << "@r1 off" << endl;
	fAgr << "@link r1 to g0" << endl;
	fAgr << "@r1 type above" << endl;
	fAgr << "@r1 linestyle 1" << endl;
	fAgr << "@r1 linewidth 1.0" << endl;
	fAgr << "@r1 color 1" << endl;
	fAgr << "@r1 line 0, 0, 0, 0" << endl;
	fAgr << "@r2 off" << endl;
	fAgr << "@link r2 to g0" << endl;
	fAgr << "@r2 type above" << endl;
	fAgr << "@r2 linestyle 1" << endl;
	fAgr << "@r2 linewidth 1.0" << endl;
	fAgr << "@r2 color 1" << endl;
	fAgr << "@r2 line 0, 0, 0, 0" << endl;
	fAgr << "@r3 off" << endl;
	fAgr << "@link r3 to g0" << endl;
	fAgr << "@r3 type above" << endl;
	fAgr << "@r3 linestyle 1" << endl;
	fAgr << "@r3 linewidth 1.0" << endl;
	fAgr << "@r3 color 1" << endl;
	fAgr << "@r3 line 0, 0, 0, 0" << endl;
	fAgr << "@r4 off" << endl;
	fAgr << "@link r4 to g0" << endl;
	fAgr << "@r4 type above" << endl;
	fAgr << "@r4 linestyle 1" << endl;
	fAgr << "@r4 linewidth 1.0" << endl;
	fAgr << "@r4 color 1" << endl;
	fAgr << "@r4 line 0, 0, 0, 0" << endl;
	fAgr << "@g0 on" << endl;
	fAgr << "@g0 hidden false" << endl;
	fAgr << "@g0 type XY" << endl;
	fAgr << "@g0 stacked false" << endl;
	fAgr << "@g0 bar hgap 0.000000" << endl;
	fAgr << "@g0 fixedpoint off" << endl;
	fAgr << "@g0 fixedpoint type 0" << endl;
	fAgr << "@g0 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g0 fixedpoint format general general" << endl;
	fAgr << "@g0 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g0" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.150000, 0.616667, 0.481373, 0.850000" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 10" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel on" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type spec" << endl;
	fAgr << "@    yaxis  ticklabel start -1.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.85, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g1 on" << endl;
	fAgr << "@g1 hidden false" << endl;
	fAgr << "@g1 type XY" << endl;
	fAgr << "@g1 stacked false" << endl;
	fAgr << "@g1 bar hgap 0.000000" << endl;
	fAgr << "@g1 fixedpoint off" << endl;
	fAgr << "@g1 fixedpoint type 0" << endl;
	fAgr << "@g1 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g1 fixedpoint format general general" << endl;
	fAgr << "@g1 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g1" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.481373, 0.616667, 0.812745, 0.850000" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g2 on" << endl;
	fAgr << "@g2 hidden false" << endl;
	fAgr << "@g2 type XY" << endl;
	fAgr << "@g2 stacked false" << endl;
	fAgr << "@g2 bar hgap 0.000000" << endl;
	fAgr << "@g2 fixedpoint off" << endl;
	fAgr << "@g2 fixedpoint type 0" << endl;
	fAgr << "@g2 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g2 fixedpoint format general general" << endl;
	fAgr << "@g2 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g2" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.812745, 0.616667, 1.144118, 0.850000" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g3 on" << endl;
	fAgr << "@g3 hidden false" << endl;
	fAgr << "@g3 type XY" << endl;
	fAgr << "@g3 stacked false" << endl;
	fAgr << "@g3 bar hgap 0.000000" << endl;
	fAgr << "@g3 fixedpoint off" << endl;
	fAgr << "@g3 fixedpoint type 0" << endl;
	fAgr << "@g3 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g3 fixedpoint format general general" << endl;
	fAgr << "@g3 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g3" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.150000, 0.383333, 0.481373, 0.616667" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"f\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.500000" << endl;
	fAgr << "@    yaxis  label font 12" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel on" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type spec" << endl;
	fAgr << "@    yaxis  ticklabel start -1.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type spec" << endl;
	fAgr << "@    yaxis  ticklabel stop 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g4 on" << endl;
	fAgr << "@g4 hidden false" << endl;
	fAgr << "@g4 type XY" << endl;
	fAgr << "@g4 stacked false" << endl;
	fAgr << "@g4 bar hgap 0.000000" << endl;
	fAgr << "@g4 fixedpoint off" << endl;
	fAgr << "@g4 fixedpoint type 0" << endl;
	fAgr << "@g4 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g4 fixedpoint format general general" << endl;
	fAgr << "@g4 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g4" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.481373, 0.383333, 0.812745, 0.616667" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g5 on" << endl;
	fAgr << "@g5 hidden false" << endl;
	fAgr << "@g5 type XY" << endl;
	fAgr << "@g5 stacked false" << endl;
	fAgr << "@g5 bar hgap 0.000000" << endl;
	fAgr << "@g5 fixedpoint off" << endl;
	fAgr << "@g5 fixedpoint type 0" << endl;
	fAgr << "@g5 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g5 fixedpoint format general general" << endl;
	fAgr << "@g5 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g5" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.812745, 0.383333, 1.144118, 0.616667" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel off" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g6 on" << endl;
	fAgr << "@g6 hidden false" << endl;
	fAgr << "@g6 type XY" << endl;
	fAgr << "@g6 stacked false" << endl;
	fAgr << "@g6 bar hgap 0.000000" << endl;
	fAgr << "@g6 fixedpoint off" << endl;
	fAgr << "@g6 fixedpoint type 0" << endl;
	fAgr << "@g6 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g6 fixedpoint format general general" << endl;
	fAgr << "@g6 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g6" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.150000, 0.150000, 0.481373, 0.383333" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel on" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type auto" << endl;
	fAgr << "@    xaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type spec" << endl;
	fAgr << "@    xaxis  ticklabel stop 9.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel on" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type spec" << endl;
	fAgr << "@    yaxis  ticklabel stop 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g7 on" << endl;
	fAgr << "@g7 hidden false" << endl;
	fAgr << "@g7 type XY" << endl;
	fAgr << "@g7 stacked false" << endl;
	fAgr << "@g7 bar hgap 0.000000" << endl;
	fAgr << "@g7 fixedpoint off" << endl;
	fAgr << "@g7 fixedpoint type 0" << endl;
	fAgr << "@g7 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g7 fixedpoint format general general" << endl;
	fAgr << "@g7 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g7" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.481373, 0.150000, 0.812745, 0.383333" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"x\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.500000" << endl;
	fAgr << "@    xaxis  label font 3" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel on" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type spec" << endl;
	fAgr << "@    xaxis  ticklabel start -5.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type spec" << endl;
	fAgr << "@    xaxis  ticklabel stop 9.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr << "@g8 on" << endl;
	fAgr << "@g8 hidden false" << endl;
	fAgr << "@g8 type XY" << endl;
	fAgr << "@g8 stacked false" << endl;
	fAgr << "@g8 bar hgap 0.000000" << endl;
	fAgr << "@g8 fixedpoint off" << endl;
	fAgr << "@g8 fixedpoint type 0" << endl;
	fAgr << "@g8 fixedpoint xy 0.000000, 0.000000" << endl;
	fAgr << "@g8 fixedpoint format general general" << endl;
	fAgr << "@g8 fixedpoint prec 6, 6" << endl;
	fAgr << "@with g8" << endl;
	fAgr << "@    world " << -L/2 <<", -2, " << L/2 << ", 2" << endl;
	fAgr << "@    stack world 0, 0, 0, 0" << endl;
	fAgr << "@    znorm 1" << endl;
	fAgr << "@    view 0.812745, 0.150000, 1.144118, 0.383333" << endl;
	fAgr << "@    title \"\"" << endl;
	fAgr << "@    title font 0" << endl;
	fAgr << "@    title size 1.500000" << endl;
	fAgr << "@    title color 1" << endl;
	fAgr << "@    subtitle \"\"" << endl;
	fAgr << "@    subtitle font 0" << endl;
	fAgr << "@    subtitle size 1.000000" << endl;
	fAgr << "@    subtitle color 1" << endl;
	fAgr << "@    xaxes scale Normal" << endl;
	fAgr << "@    yaxes scale Normal" << endl;
	fAgr << "@    xaxes invert off" << endl;
	fAgr << "@    yaxes invert off" << endl;
	fAgr << "@    xaxis  on" << endl;
	fAgr << "@    xaxis  type zero false" << endl;
	fAgr << "@    xaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    xaxis  bar on" << endl;
	fAgr << "@    xaxis  bar color 1" << endl;
	fAgr << "@    xaxis  bar linestyle 1" << endl;
	fAgr << "@    xaxis  bar linewidth 1.0" << endl;
	fAgr << "@    xaxis  label \"\"" << endl;
	fAgr << "@    xaxis  label layout para" << endl;
	fAgr << "@    xaxis  label place auto" << endl;
	fAgr << "@    xaxis  label char size 1.000000" << endl;
	fAgr << "@    xaxis  label font 0" << endl;
	fAgr << "@    xaxis  label color 1" << endl;
	fAgr << "@    xaxis  label place normal" << endl;
	fAgr << "@    xaxis  tick on" << endl;
	fAgr << "@    xaxis  tick major 5" << endl;
	fAgr << "@    xaxis  tick minor ticks 4" << endl;
	fAgr << "@    xaxis  tick default 6" << endl;
	fAgr << "@    xaxis  tick place rounded true" << endl;
	fAgr << "@    xaxis  tick in" << endl;
	fAgr << "@    xaxis  tick major size 1.000000" << endl;
	fAgr << "@    xaxis  tick major color 1" << endl;
	fAgr << "@    xaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick major linestyle 1" << endl;
	fAgr << "@    xaxis  tick major grid off" << endl;
	fAgr << "@    xaxis  tick minor color 1" << endl;
	fAgr << "@    xaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    xaxis  tick minor linestyle 1" << endl;
	fAgr << "@    xaxis  tick minor grid off" << endl;
	fAgr << "@    xaxis  tick minor size 0.500000" << endl;
	fAgr << "@    xaxis  ticklabel on" << endl;
	fAgr << "@    xaxis  ticklabel format general" << endl;
	fAgr << "@    xaxis  ticklabel prec 5" << endl;
	fAgr << "@    xaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    xaxis  ticklabel append \"\"" << endl;
	fAgr << "@    xaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    xaxis  ticklabel angle 0" << endl;
	fAgr << "@    xaxis  ticklabel skip 0" << endl;
	fAgr << "@    xaxis  ticklabel stagger 0" << endl;
	fAgr << "@    xaxis  ticklabel place normal" << endl;
	fAgr << "@    xaxis  ticklabel offset auto" << endl;
	fAgr << "@    xaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    xaxis  ticklabel start type spec" << endl;
	fAgr << "@    xaxis  ticklabel start -5.000000" << endl;
	fAgr << "@    xaxis  ticklabel stop type auto" << endl;
	fAgr << "@    xaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    xaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    xaxis  ticklabel font 0" << endl;
	fAgr << "@    xaxis  ticklabel color 1" << endl;
	fAgr << "@    xaxis  tick place both" << endl;
	fAgr << "@    xaxis  tick spec type none" << endl;
	fAgr << "@    yaxis  on" << endl;
	fAgr << "@    yaxis  type zero false" << endl;
	fAgr << "@    yaxis  offset 0.000000 , 0.000000" << endl;
	fAgr << "@    yaxis  bar on" << endl;
	fAgr << "@    yaxis  bar color 1" << endl;
	fAgr << "@    yaxis  bar linestyle 1" << endl;
	fAgr << "@    yaxis  bar linewidth 1.0" << endl;
	fAgr << "@    yaxis  label \"\"" << endl;
	fAgr << "@    yaxis  label layout para" << endl;
	fAgr << "@    yaxis  label place auto" << endl;
	fAgr << "@    yaxis  label char size 1.000000" << endl;
	fAgr << "@    yaxis  label font 0" << endl;
	fAgr << "@    yaxis  label color 1" << endl;
	fAgr << "@    yaxis  label place normal" << endl;
	fAgr << "@    yaxis  tick on" << endl;
	fAgr << "@    yaxis  tick major 1" << endl;
	fAgr << "@    yaxis  tick minor ticks 1" << endl;
	fAgr << "@    yaxis  tick default 6" << endl;
	fAgr << "@    yaxis  tick place rounded true" << endl;
	fAgr << "@    yaxis  tick in" << endl;
	fAgr << "@    yaxis  tick major size 1.000000" << endl;
	fAgr << "@    yaxis  tick major color 1" << endl;
	fAgr << "@    yaxis  tick major linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick major linestyle 1" << endl;
	fAgr << "@    yaxis  tick major grid off" << endl;
	fAgr << "@    yaxis  tick minor color 1" << endl;
	fAgr << "@    yaxis  tick minor linewidth 1.0" << endl;
	fAgr << "@    yaxis  tick minor linestyle 1" << endl;
	fAgr << "@    yaxis  tick minor grid off" << endl;
	fAgr << "@    yaxis  tick minor size 0.500000" << endl;
	fAgr << "@    yaxis  ticklabel off" << endl;
	fAgr << "@    yaxis  ticklabel format general" << endl;
	fAgr << "@    yaxis  ticklabel prec 5" << endl;
	fAgr << "@    yaxis  ticklabel formula \"\"" << endl;
	fAgr << "@    yaxis  ticklabel append \"\"" << endl;
	fAgr << "@    yaxis  ticklabel prepend \"\"" << endl;
	fAgr << "@    yaxis  ticklabel angle 0" << endl;
	fAgr << "@    yaxis  ticklabel skip 0" << endl;
	fAgr << "@    yaxis  ticklabel stagger 0" << endl;
	fAgr << "@    yaxis  ticklabel place normal" << endl;
	fAgr << "@    yaxis  ticklabel offset auto" << endl;
	fAgr << "@    yaxis  ticklabel offset 0.000000 , 0.010000" << endl;
	fAgr << "@    yaxis  ticklabel start type auto" << endl;
	fAgr << "@    yaxis  ticklabel start 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel stop type auto" << endl;
	fAgr << "@    yaxis  ticklabel stop 0.000000" << endl;
	fAgr << "@    yaxis  ticklabel char size 1.000000" << endl;
	fAgr << "@    yaxis  ticklabel font 0" << endl;
	fAgr << "@    yaxis  ticklabel color 1" << endl;
	fAgr << "@    yaxis  tick place both" << endl;
	fAgr << "@    yaxis  tick spec type none" << endl;
	fAgr << "@    altxaxis  off" << endl;
	fAgr << "@    altyaxis  off" << endl;
	fAgr << "@    legend on" << endl;
	fAgr << "@    legend loctype view" << endl;
	fAgr << "@    legend 0.5, 0.8" << endl;
	fAgr << "@    legend box color 1" << endl;
	fAgr << "@    legend box pattern 1" << endl;
	fAgr << "@    legend box linewidth 1.0" << endl;
	fAgr << "@    legend box linestyle 1" << endl;
	fAgr << "@    legend box fill color 0" << endl;
	fAgr << "@    legend box fill pattern 1" << endl;
	fAgr << "@    legend font 0" << endl;
	fAgr << "@    legend char size 1.000000" << endl;
	fAgr << "@    legend color 1" << endl;
	fAgr << "@    legend length 4" << endl;
	fAgr << "@    legend vgap 1" << endl;
	fAgr << "@    legend hgap 1" << endl;
	fAgr << "@    legend invert false" << endl;
	fAgr << "@    frame type 0" << endl;
	fAgr << "@    frame linestyle 1" << endl;
	fAgr << "@    frame linewidth 1.0" << endl;
	fAgr << "@    frame color 1" << endl;
	fAgr << "@    frame pattern 1" << endl;
	fAgr << "@    frame background color 0" << endl;
	fAgr << "@    frame background pattern 0" << endl;
	fAgr << "@    s0 hidden false" << endl;
	fAgr << "@    s0 type xy" << endl;
	fAgr << "@    s0 symbol 0" << endl;
	fAgr << "@    s0 symbol size 1.000000" << endl;
	fAgr << "@    s0 symbol color 1" << endl;
	fAgr << "@    s0 symbol pattern 1" << endl;
	fAgr << "@    s0 symbol fill color 1" << endl;
	fAgr << "@    s0 symbol fill pattern 0" << endl;
	fAgr << "@    s0 symbol linewidth 1.0" << endl;
	fAgr << "@    s0 symbol linestyle 1" << endl;
	fAgr << "@    s0 symbol char 65" << endl;
	fAgr << "@    s0 symbol char font 0" << endl;
	fAgr << "@    s0 symbol skip 0" << endl;
	fAgr << "@    s0 line type 1" << endl;
	fAgr << "@    s0 line linestyle 1" << endl;
	fAgr << "@    s0 line linewidth 2.0" << endl;
	fAgr << "@    s0 line color 1" << endl;
	fAgr << "@    s0 line pattern 1" << endl;
	fAgr << "@    s0 baseline type 0" << endl;
	fAgr << "@    s0 baseline off" << endl;
	fAgr << "@    s0 dropline off" << endl;
	fAgr << "@    s0 fill type 0" << endl;
	fAgr << "@    s0 fill rule 0" << endl;
	fAgr << "@    s0 fill color 1" << endl;
	fAgr << "@    s0 fill pattern 1" << endl;
	fAgr << "@    s0 avalue off" << endl;
	fAgr << "@    s0 avalue type 2" << endl;
	fAgr << "@    s0 avalue char size 1.000000" << endl;
	fAgr << "@    s0 avalue font 0" << endl;
	fAgr << "@    s0 avalue color 1" << endl;
	fAgr << "@    s0 avalue rot 0" << endl;
	fAgr << "@    s0 avalue format general" << endl;
	fAgr << "@    s0 avalue prec 3" << endl;
	fAgr << "@    s0 avalue prepend \"\"" << endl;
	fAgr << "@    s0 avalue append \"\"" << endl;
	fAgr << "@    s0 avalue offset 0.000000 , 0.000000" << endl;
	fAgr << "@    s0 errorbar on" << endl;
	fAgr << "@    s0 errorbar place both" << endl;
	fAgr << "@    s0 errorbar color 1" << endl;
	fAgr << "@    s0 errorbar pattern 1" << endl;
	fAgr << "@    s0 errorbar size 1.000000" << endl;
	fAgr << "@    s0 errorbar linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser linewidth 1.0" << endl;
	fAgr << "@    s0 errorbar riser linestyle 1" << endl;
	fAgr << "@    s0 errorbar riser clip off" << endl;
	fAgr << "@    s0 errorbar riser clip length 0.100000" << endl;
	fAgr << "@    s0 comment \"/home/alberto/prog/iModes/nonloc_1_00.dat\"" << endl;
	fAgr << "@    s0 legend  \"\"" << endl;
	fAgr.close();
}
